{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://reputation.omatrust.org/schemas/security-assessment/attestation/1.4.0.json",
  "title": "Security Assessment",
  "description": "Use this form to record a security assessment onchain",
  "type": "object",
  "keywords": [
    "security",
    "pentest",
    "audit",
    "assessment",
    "vulnerability",
    "attestation",
    "reputation"
  ],
  "required": [
    "attester",
    "subject",
    "payload",
    "payloadVersion",
    "issuedAt"
  ],
  "properties": {
    "@context": {
      "type": "string",
      "description": "Optional JSON-LD context URI for semantic processing.",
      "default": "https://oma3.org/context.jsonld",
      "maxLength": 256,
      "x-oma3-skip-reason": "metadata"
    },
    "@type": {
      "type": "string",
      "description": "Semantic type identifier, typically 'SecurityAssessment'.",
      "default": "SecurityAssessment",
      "maxLength": 100,
      "x-oma3-skip-reason": "metadata"
    },
    "attester": {
      "type": "string",
      "title": "Attester ID",
      "format": "did",
      "pattern": "^did:[a-z0-9]+:.+$",
      "description": "DID of the assessment issuer.",
      "maxLength": 256,
      "x-oma3-did-methods": ["web", "pkh", "key"],
      "x-oma3-skip-reason": "eas"
    },
    "subject": {
      "type": "string",
      "title": "Subject ID",
      "format": "did",
      "pattern": "^did:[a-z0-9]+:.+$",
      "description": "ID of the assessed application/contract/service. Select an ID type below and enter the proper identity.",
      "maxLength": 256,
      "x-oma3-did-methods": ["web", "pkh", "key"]
    },
    "organization": {
      "type": "string",
      "title": "Organization",
      "format": "did",
      "pattern": "^did:[a-z0-9]+:.+$",
      "description": "DID of the parent organization. Use this when assessing a service or resource that belongs to an organization (e.g., assessing did:web:example.com:service:api, set organization to did:web:example.com). Leave empty when assessing an organization directly.",
      "maxLength": 256,
      "x-oma3-did-methods": ["web", "pkh"]
    },
    "version": {
      "$ref": "common.schema.json#/$defs/Version",
      "title": "Software Version",
      "description": "Semantic version of the software/code that was assessed (e.g., '1.2.3')."
    },
    "versionHW": {
      "type": "string",
      "title": "Hardware Version",
      "description": "Hardware version of the assessed subject, if applicable.",
      "maxLength": 50
    },
    "payload": {
      "type": "object",
      "title": "Assessment Payload",
      "description": "Assessment details. Evolvable without changing the envelope. When stored on-chain via EAS, this object is JSON-stringified.",
      "x-oma3-render": "expanded",
      "properties": {
        "assessmentKind": {
          "type": "string",
          "title": "Assessment Kind",
          "description": "High-level category of the assessment. Registered kinds are defined in the OMA3 Assessment Kind Registry.",
          "maxLength": 64,
          "x-oma3-enum": [
            "pentest",
            "security-audit",
            "code-review",
            "vulnerability-scan"
          ]
        },
        "period": {
          "type": "object",
          "title": "Assessment Timeframe",
          "description": "When the assessment occurred.",
          "x-oma3-skip-reason": "unused",
          "properties": {
            "start": {
              "type": "integer",
              "minimum": 0,
              "title": "Assessment Start Time",
              "description": "Unix timestamp (in seconds) for when the assessment began. OK to leave empty.",
              "x-oma3-subtype": "timestamp"
            },
            "end": {
              "type": "integer",
              "minimum": 0,
              "title": "Assessment End Time",
              "description": "Unix timestamp (in seconds) for when the assessment completed. OK to leave empty.",
              "x-oma3-subtype": "timestamp"
            }
          },
          "additionalProperties": false
        },
        "methodURI": {
          "type": "string",
          "format": "uri",
          "title": "Methodology URI",
          "description": "Methodology / SOP documentation.",
          "maxLength": 256
        },
        "reportURI": {
          "type": "string",
          "format": "uri",
          "title": "Report URI",
          "description": "Human-readable report location (may be mutable).",
          "maxLength": 256
        },
        "reportDigest": {
          "$ref": "common.schema.json#/$defs/ReportDigest"
        },
        "outcome": {
          "$ref": "common.schema.json#/$defs/Outcome"
        },
        "metrics": {
          "type": "object",
          "title": "Finding Metrics",
          "description": "Optional summarized finding counts.",
          "x-oma3-skip-reason": "unused",
          "properties": {
            "critical": {
              "type": "integer",
              "title": "Critical Findings",
              "minimum": 0,
              "description": "Number of critical severity findings."
            },
            "high": {
              "type": "integer",
              "title": "High Findings",
              "minimum": 0,
              "description": "Number of high severity findings."
            },
            "medium": {
              "type": "integer",
              "title": "Medium Findings",
              "minimum": 0,
              "description": "Number of medium severity findings."
            },
            "low": {
              "type": "integer",
              "title": "Low Findings",
              "minimum": 0,
              "description": "Number of low severity findings."
            },
            "info": {
              "type": "integer",
              "title": "Informational Findings",
              "minimum": 0,
              "description": "Number of informational findings."
            }
          },
          "additionalProperties": false
        },
        "policyLinks": {
          "type": "array",
          "title": "Policy Links",
          "description": "Zero or more policy/process links relevant to this assessment.",
          "x-oma3-skip-reason": "unused",
          "items": {
            "type": "string",
            "format": "uri",
            "maxLength": 256
          }
        },
        "extensions": {
          "type": "object",
          "title": "Extensions",
          "description": "Vendor-specific fields. Namespaced keys recommended.",
          "x-oma3-skip-reason": "unused",
          "additionalProperties": true
        }
      },
      "required": [
        "assessmentKind"
      ],
      "additionalProperties": true
    },
    "payloadVersion": {
      "$ref": "common.schema.json#/$defs/PayloadVersion"
    },
    "payloadSpecURI": {
      "$ref": "common.schema.json#/$defs/PayloadSpecURI"
    },
    "payloadSpecDigest": {
      "$ref": "common.schema.json#/$defs/PayloadSpecDigest"
    },
    "issuedAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Issued Date",
      "description": "Unix timestamp (in seconds) when the attestation was issued. Default is the current time.",
      "x-oma3-subtype": "timestamp",
      "x-oma3-default": "current-timestamp"
    },
    "effectiveAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Effective Date",
      "description": "Optional Unix timestamp (in seconds) when the assessment becomes effective. Default is the current time.",
      "x-oma3-subtype": "timestamp",
      "x-oma3-default": "current-timestamp"
    },
    "expiresAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Expiration Date",
      "description": "Unix timestamp (in seconds) after which the assessment expires. Leave empty if the assessment does not expire.",
      "x-oma3-subtype": "timestamp"
    }
  },
  "additionalProperties": false
}
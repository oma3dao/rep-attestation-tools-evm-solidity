{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://reputation.omatrust.org/schemas/linked-identifier/attestation/1.0.0.json",
  "title": "Linked Identifier",
  "description": "An attestation where the attester (a trusted third party) asserts that the subject controls the linked identifier, effectively attesting that two identities are owned by the same entity.",
  "type": "object",
  "required": [
    "attester",
    "subject",
    "linkedId",
    "method",
    "issuedAt"
  ],
  "properties": {
    "@context": {
      "type": "string",
      "description": "Optional JSON-LD context URI for semantic processing.",
      "default": "https://oma3.org/context.jsonld",
      "x-oma3-skip-reason": "metadata"
    },
    "@type": {
      "type": "string",
      "description": "Semantic type identifier, typically 'LinkedIdentifierAttestation'.",
      "default": "LinkedIdentifierAttestation",
      "x-oma3-skip-reason": "metadata"
    },
    "attester": {
      "type": "string",
      "title": "Attester ID",
      "description": "DID of the third-party entity making the assertion. This entity has verified the linkage between the subject and linkedId.",
      "x-oma3-skip-reason": "eas"
    },
    "subject": {
      "type": "string",
      "title": "Subject ID",
      "format": "did",
      "description": "DID of the subject (such as did:pkh for wallet addresses or did:web for web domains) that is claimed to control the linked identifier.",
      "maxLength": 128
    },
    "linkedId": {
      "type": "string",
      "title": "Linked Identifier",
      "description": "The identifier being claimed as controlled by the subject (e.g., a did:web, email address, or domain).",
      "maxLength": 256
    },
    "linkedIdType": {
      "type": "string",
      "title": "Linked ID Type",
      "description": "Type or namespace of the linkedId being asserted. Examples: did:web (for websites), did:key (for keys), email, twitter, github, facebook, discord, telegram, lens, farcaster, or any other well-known identifier type.",
      "maxLength": 100
    },
    "method": {
      "type": "string",
      "enum": [
        "http-file",
        "dns-txt",
        "email-challenge",
        "social-post",
        "manual",
        "oauth",
        "other"
      ],
      "title": "Verification Method",
      "description": "Verification method used by the attester to confirm the subject's control of the linkedId."
    },
    "issuedAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Issued Date",
      "description": "Unix timestamp (in seconds) when the attestation was issued. Default is the current time.",
      "x-oma3-subtype": "timestamp",
      "x-oma3-default": "current-timestamp"
    },
    "effectiveAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Effective Date",
      "description": "Optional Unix timestamp (in seconds) when the assessment becomes effective. Default is the current time.",
      "x-oma3-subtype": "timestamp",
      "x-oma3-default": "current-timestamp"
    },
    "expiresAt": {
      "type": "integer",
      "minimum": 0,
      "title": "Expiration Date",
      "description": "Unix timestamp (in seconds) after which the assessment expires. Leave empty if the assessment does not expire.",
      "x-oma3-subtype": "timestamp"
    }
  },
  "additionalProperties": false
}